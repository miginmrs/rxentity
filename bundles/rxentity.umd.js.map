{"version":3,"sources":["webpack://rxentity/webpack/universalModuleDefinition","webpack://rxentity/webpack/bootstrap","webpack://rxentity/./node_modules/altern-map/dist/esm/altern-map.js","webpack://rxentity/./node_modules/altern-map/dist/esm/index.js","webpack://rxentity/./node_modules/rxjs/internal/InnerSubscriber.js","webpack://rxentity/./node_modules/rxjs/internal/Observable.js","webpack://rxentity/./node_modules/rxjs/internal/Observer.js","webpack://rxentity/./node_modules/rxjs/internal/OuterSubscriber.js","webpack://rxentity/./node_modules/rxjs/internal/Subscriber.js","webpack://rxentity/./node_modules/rxjs/internal/Subscription.js","webpack://rxentity/./node_modules/rxjs/internal/config.js","webpack://rxentity/./node_modules/rxjs/internal/symbol/iterator.js","webpack://rxentity/./node_modules/rxjs/internal/symbol/observable.js","webpack://rxentity/./node_modules/rxjs/internal/symbol/rxSubscriber.js","webpack://rxentity/./node_modules/rxjs/internal/util/UnsubscriptionError.js","webpack://rxentity/./node_modules/rxjs/internal/util/canReportError.js","webpack://rxentity/./node_modules/rxjs/internal/util/hostReportError.js","webpack://rxentity/./node_modules/rxjs/internal/util/identity.js","webpack://rxentity/./node_modules/rxjs/internal/util/isArray.js","webpack://rxentity/./node_modules/rxjs/internal/util/isArrayLike.js","webpack://rxentity/./node_modules/rxjs/internal/util/isFunction.js","webpack://rxentity/./node_modules/rxjs/internal/util/isObject.js","webpack://rxentity/./node_modules/rxjs/internal/util/isPromise.js","webpack://rxentity/./node_modules/rxjs/internal/util/pipe.js","webpack://rxentity/./node_modules/rxjs/internal/util/subscribeTo.js","webpack://rxentity/./node_modules/rxjs/internal/util/subscribeToArray.js","webpack://rxentity/./node_modules/rxjs/internal/util/subscribeToIterable.js","webpack://rxentity/./node_modules/rxjs/internal/util/subscribeToObservable.js","webpack://rxentity/./node_modules/rxjs/internal/util/subscribeToPromise.js","webpack://rxentity/./node_modules/rxjs/internal/util/subscribeToResult.js","webpack://rxentity/./node_modules/rxjs/internal/util/toSubscriber.js","webpack://rxentity/./node_modules/rxvalue/dist/esm/index.js","webpack://rxentity/./node_modules/rxvalue/dist/esm/rxvalue.js","webpack://rxentity/./source/common.ts","webpack://rxentity/./source/entity/entity-abstract.ts","webpack://rxentity/./source/entity/entity-child-impl.ts","webpack://rxentity/./source/entity/entity-impl.ts","webpack://rxentity/./source/entity/entity-proxies.ts","webpack://rxentity/./source/entity/index.ts","webpack://rxentity/./source/index.ts","webpack://rxentity/./source/list/index.ts","webpack://rxentity/./source/list/stored-list.ts","webpack://rxentity/./source/store.ts","webpack://rxentity/external {\"root\":[\"rxjs\"],\"commonjs\":\"rxjs\",\"commonjs2\":\"rxjs\",\"amd\":\"rxjs\"}","webpack://rxentity/external {\"root\":[\"rxjs\",\"operators\"],\"commonjs\":\"rxjs/operators\",\"commonjs2\":\"rxjs/operators\",\"amd\":\"rxjs/operators\"}"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgE;AACA;AACS;AAClE;AACP;AACA,mFAAmF;AACnF;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,6EAAe;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,6EAAe;AACnD;AACA;AACA,iCAAiC,8FAAiB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,oBAAoB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sC;;;;;;;;;;;;AC5EA;AAAA;AAAA;AAAA;AAA6B;AAC7B,iC;;;;;;;;;;;;ACDa;AACb;AACA;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,gEAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,2C;;;;;;;;;;;;ACxCa;AACb,8CAA8C,cAAc;AAC5D,uBAAuB,mBAAO,CAAC,kFAAuB;AACtD,qBAAqB,mBAAO,CAAC,8EAAqB;AAClD,mBAAmB,mBAAO,CAAC,8EAAqB;AAChD,aAAa,mBAAO,CAAC,8DAAa;AAClC,eAAe,mBAAO,CAAC,wDAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,kBAAkB,EAAE,kBAAkB,oBAAoB,EAAE,eAAe,uBAAuB,EAAE;AAC9I,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sC;;;;;;;;;;;;ACpHa;AACb,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,wDAAU;AACjC,wBAAwB,mBAAO,CAAC,oFAAwB;AACxD;AACA;AACA,4BAA4B,EAAE;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,2BAA2B;AAC3B;AACA,oC;;;;;;;;;;;;ACjBa;AACb;AACA;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,gEAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,2C;;;;;;;;;;;;ACjCa;AACb;AACA;AACA;AACA,cAAc,gBAAgB,sCAAsC,iBAAiB,EAAE;AACvF,6BAA6B,uDAAuD;AACpF;AACA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,0EAAmB;AAC9C,iBAAiB,mBAAO,CAAC,4DAAY;AACrC,qBAAqB,mBAAO,CAAC,oEAAgB;AAC7C,qBAAqB,mBAAO,CAAC,4FAAiC;AAC9D,eAAe,mBAAO,CAAC,wDAAU;AACjC,wBAAwB,mBAAO,CAAC,oFAAwB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,aAAa;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,6CAA6C;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,sC;;;;;;;;;;;;ACrPa;AACb,8CAA8C,cAAc;AAC5D,gBAAgB,mBAAO,CAAC,oEAAgB;AACxC,iBAAiB,mBAAO,CAAC,sEAAiB;AAC1C,mBAAmB,mBAAO,CAAC,0EAAmB;AAC9C,4BAA4B,mBAAO,CAAC,4FAA4B;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,iCAAiC;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA,+CAA+C,mGAAmG,EAAE;AACpJ;AACA,wC;;;;;;;;;;;;AC5Ia;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,kC;;;;;;;;;;;;ACnBa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oC;;;;;;;;;;;;ACXa;AACb,8CAA8C,cAAc;AAC5D,mCAAmC,4EAA4E,EAAE;AACjH,sC;;;;;;;;;;;;ACHa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,wC;;;;;;;;;;;;ACRa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA,wGAAwG,sCAAsC,EAAE;AAChJ;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,+C;;;;;;;;;;;;ACfa;AACb,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,iEAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0C;;;;;;;;;;;;ACnBa;AACb,8CAA8C,cAAc;AAC5D;AACA,4BAA4B,WAAW,EAAE;AACzC;AACA;AACA,2C;;;;;;;;;;;;ACNa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA,oC;;;;;;;;;;;;ACNa;AACb,8CAA8C,cAAc;AAC5D,gCAAgC,wCAAwC,0CAA0C,EAA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","file":"rxentity.umd.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"rxjs\"), require(\"rxjs/operators\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"rxjs\", \"rxjs/operators\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"rxentity\"] = factory(require(\"rxjs\"), require(\"rxjs/operators\"));\n\telse\n\t\troot[\"rxentity\"] = factory(root[\"rxjs\"], root[\"rxjs\"][\"operators\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE_rxjs__, __WEBPACK_EXTERNAL_MODULE_rxjs_operators__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./source/index.ts\");\n","import { OuterSubscriber } from 'rxjs/internal/OuterSubscriber';\nimport { InnerSubscriber } from 'rxjs/internal/InnerSubscriber';\nimport { subscribeToResult } from 'rxjs/internal/util/subscribeToResult';\nexport function alternMap(...args) {\n    const [project, options] = args;\n    const op = (source) => source.lift(new AlternMapOperator(project, options || {}));\n    if (!args[2])\n        return op;\n    const p = args[0];\n    return (source) => Object.defineProperty(op(source), 'value', {\n        get: () => p(source.value, -1).value\n    });\n}\nclass AlternMapOperator {\n    constructor(project, options) {\n        this.project = project;\n        this.options = options;\n    }\n    call(subscriber, source) {\n        return source.subscribe(new AlternMapSubscriber(subscriber, this.project, this.options));\n    }\n}\nclass AlternMapSubscriber extends OuterSubscriber {\n    constructor(destination, project, options) {\n        super(destination);\n        this.project = project;\n        this.options = options;\n        this.index = 0;\n    }\n    _next(value) {\n        let result;\n        const index = this.index++;\n        try {\n            result = this.project(value, index);\n        }\n        catch (error) {\n            this.destination.error(error);\n            return;\n        }\n        this._innerSub(result, value, index);\n    }\n    _innerSub(result, value, index) {\n        const innerSubscription = this.innerSubscription;\n        const innerSubscriber = new InnerSubscriber(this, value, index);\n        const destination = this.destination;\n        destination.add(innerSubscriber);\n        this.innerSubscription = subscribeToResult(this, result, undefined, undefined, innerSubscriber);\n        if (this.innerSubscription !== innerSubscriber) {\n            destination.add(this.innerSubscription);\n        }\n        if (innerSubscription) {\n            innerSubscription.unsubscribe();\n        }\n    }\n    _complete() {\n        const { innerSubscription } = this;\n        if (!innerSubscription || innerSubscription.closed || this.options.completeWithSource) {\n            super._complete();\n        }\n        this.unsubscribe();\n    }\n    _unsubscribe() {\n        this.innerSubscription = null;\n    }\n    notifyComplete(innerSub) {\n        const destination = this.destination;\n        destination.remove(innerSub);\n        this.innerSubscription = null;\n        if (this.isStopped || this.options.completeWithInner) {\n            super._complete();\n        }\n    }\n    notifyNext(outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.destination.next(innerValue);\n    }\n}\n//# sourceMappingURL=altern-map.js.map","export * from './altern-map';\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"./Subscriber\");\nvar InnerSubscriber = (function (_super) {\n    __extends(InnerSubscriber, _super);\n    function InnerSubscriber(parent, outerValue, outerIndex) {\n        var _this = _super.call(this) || this;\n        _this.parent = parent;\n        _this.outerValue = outerValue;\n        _this.outerIndex = outerIndex;\n        _this.index = 0;\n        return _this;\n    }\n    InnerSubscriber.prototype._next = function (value) {\n        this.parent.notifyNext(this.outerValue, value, this.outerIndex, this.index++, this);\n    };\n    InnerSubscriber.prototype._error = function (error) {\n        this.parent.notifyError(error, this);\n        this.unsubscribe();\n    };\n    InnerSubscriber.prototype._complete = function () {\n        this.parent.notifyComplete(this);\n        this.unsubscribe();\n    };\n    return InnerSubscriber;\n}(Subscriber_1.Subscriber));\nexports.InnerSubscriber = InnerSubscriber;\n//# sourceMappingURL=InnerSubscriber.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar canReportError_1 = require(\"./util/canReportError\");\nvar toSubscriber_1 = require(\"./util/toSubscriber\");\nvar observable_1 = require(\"./symbol/observable\");\nvar pipe_1 = require(\"./util/pipe\");\nvar config_1 = require(\"./config\");\nvar Observable = (function () {\n    function Observable(subscribe) {\n        this._isScalar = false;\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var operator = this.operator;\n        var sink = toSubscriber_1.toSubscriber(observerOrNext, error, complete);\n        if (operator) {\n            sink.add(operator.call(sink, this.source));\n        }\n        else {\n            sink.add(this.source || (config_1.config.useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable) ?\n                this._subscribe(sink) :\n                this._trySubscribe(sink));\n        }\n        if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n            if (sink.syncErrorThrowable) {\n                sink.syncErrorThrowable = false;\n                if (sink.syncErrorThrown) {\n                    throw sink.syncErrorValue;\n                }\n            }\n        }\n        return sink;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n                sink.syncErrorThrown = true;\n                sink.syncErrorValue = err;\n            }\n            if (canReportError_1.canReportError(sink)) {\n                sink.error(err);\n            }\n            else {\n                console.warn(err);\n            }\n        }\n    };\n    Observable.prototype.forEach = function (next, promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var subscription;\n            subscription = _this.subscribe(function (value) {\n                try {\n                    next(value);\n                }\n                catch (err) {\n                    reject(err);\n                    if (subscription) {\n                        subscription.unsubscribe();\n                    }\n                }\n            }, reject, resolve);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        var source = this.source;\n        return source && source.subscribe(subscriber);\n    };\n    Observable.prototype[observable_1.observable] = function () {\n        return this;\n    };\n    Observable.prototype.pipe = function () {\n        var operations = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            operations[_i] = arguments[_i];\n        }\n        if (operations.length === 0) {\n            return this;\n        }\n        return pipe_1.pipeFromArray(operations)(this);\n    };\n    Observable.prototype.toPromise = function (promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var value;\n            _this.subscribe(function (x) { return value = x; }, function (err) { return reject(err); }, function () { return resolve(value); });\n        });\n    };\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexports.Observable = Observable;\nfunction getPromiseCtor(promiseCtor) {\n    if (!promiseCtor) {\n        promiseCtor = config_1.config.Promise || Promise;\n    }\n    if (!promiseCtor) {\n        throw new Error('no Promise impl found');\n    }\n    return promiseCtor;\n}\n//# sourceMappingURL=Observable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar config_1 = require(\"./config\");\nvar hostReportError_1 = require(\"./util/hostReportError\");\nexports.empty = {\n    closed: true,\n    next: function (value) { },\n    error: function (err) {\n        if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n            throw err;\n        }\n        else {\n            hostReportError_1.hostReportError(err);\n        }\n    },\n    complete: function () { }\n};\n//# sourceMappingURL=Observer.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"./Subscriber\");\nvar OuterSubscriber = (function (_super) {\n    __extends(OuterSubscriber, _super);\n    function OuterSubscriber() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    OuterSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.destination.next(innerValue);\n    };\n    OuterSubscriber.prototype.notifyError = function (error, innerSub) {\n        this.destination.error(error);\n    };\n    OuterSubscriber.prototype.notifyComplete = function (innerSub) {\n        this.destination.complete();\n    };\n    return OuterSubscriber;\n}(Subscriber_1.Subscriber));\nexports.OuterSubscriber = OuterSubscriber;\n//# sourceMappingURL=OuterSubscriber.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar isFunction_1 = require(\"./util/isFunction\");\nvar Observer_1 = require(\"./Observer\");\nvar Subscription_1 = require(\"./Subscription\");\nvar rxSubscriber_1 = require(\"../internal/symbol/rxSubscriber\");\nvar config_1 = require(\"./config\");\nvar hostReportError_1 = require(\"./util/hostReportError\");\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    function Subscriber(destinationOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        _this.syncErrorValue = null;\n        _this.syncErrorThrown = false;\n        _this.syncErrorThrowable = false;\n        _this.isStopped = false;\n        switch (arguments.length) {\n            case 0:\n                _this.destination = Observer_1.empty;\n                break;\n            case 1:\n                if (!destinationOrNext) {\n                    _this.destination = Observer_1.empty;\n                    break;\n                }\n                if (typeof destinationOrNext === 'object') {\n                    if (destinationOrNext instanceof Subscriber) {\n                        _this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;\n                        _this.destination = destinationOrNext;\n                        destinationOrNext.add(_this);\n                    }\n                    else {\n                        _this.syncErrorThrowable = true;\n                        _this.destination = new SafeSubscriber(_this, destinationOrNext);\n                    }\n                    break;\n                }\n            default:\n                _this.syncErrorThrowable = true;\n                _this.destination = new SafeSubscriber(_this, destinationOrNext, error, complete);\n                break;\n        }\n        return _this;\n    }\n    Subscriber.prototype[rxSubscriber_1.rxSubscriber] = function () { return this; };\n    Subscriber.create = function (next, error, complete) {\n        var subscriber = new Subscriber(next, error, complete);\n        subscriber.syncErrorThrowable = false;\n        return subscriber;\n    };\n    Subscriber.prototype.next = function (value) {\n        if (!this.isStopped) {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.isStopped = true;\n        _super.prototype.unsubscribe.call(this);\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        this.destination.error(err);\n        this.unsubscribe();\n    };\n    Subscriber.prototype._complete = function () {\n        this.destination.complete();\n        this.unsubscribe();\n    };\n    Subscriber.prototype._unsubscribeAndRecycle = function () {\n        var _parentOrParents = this._parentOrParents;\n        this._parentOrParents = null;\n        this.unsubscribe();\n        this.closed = false;\n        this.isStopped = false;\n        this._parentOrParents = _parentOrParents;\n        return this;\n    };\n    return Subscriber;\n}(Subscription_1.Subscription));\nexports.Subscriber = Subscriber;\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        _this._parentSubscriber = _parentSubscriber;\n        var next;\n        var context = _this;\n        if (isFunction_1.isFunction(observerOrNext)) {\n            next = observerOrNext;\n        }\n        else if (observerOrNext) {\n            next = observerOrNext.next;\n            error = observerOrNext.error;\n            complete = observerOrNext.complete;\n            if (observerOrNext !== Observer_1.empty) {\n                context = Object.create(observerOrNext);\n                if (isFunction_1.isFunction(context.unsubscribe)) {\n                    _this.add(context.unsubscribe.bind(context));\n                }\n                context.unsubscribe = _this.unsubscribe.bind(_this);\n            }\n        }\n        _this._context = context;\n        _this._next = next;\n        _this._error = error;\n        _this._complete = complete;\n        return _this;\n    }\n    SafeSubscriber.prototype.next = function (value) {\n        if (!this.isStopped && this._next) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (!config_1.config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                this.__tryOrUnsub(this._next, value);\n            }\n            else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            var useDeprecatedSynchronousErrorHandling = config_1.config.useDeprecatedSynchronousErrorHandling;\n            if (this._error) {\n                if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(this._error, err);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, this._error, err);\n                    this.unsubscribe();\n                }\n            }\n            else if (!_parentSubscriber.syncErrorThrowable) {\n                this.unsubscribe();\n                if (useDeprecatedSynchronousErrorHandling) {\n                    throw err;\n                }\n                hostReportError_1.hostReportError(err);\n            }\n            else {\n                if (useDeprecatedSynchronousErrorHandling) {\n                    _parentSubscriber.syncErrorValue = err;\n                    _parentSubscriber.syncErrorThrown = true;\n                }\n                else {\n                    hostReportError_1.hostReportError(err);\n                }\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.complete = function () {\n        var _this = this;\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (this._complete) {\n                var wrappedComplete = function () { return _this._complete.call(_this._context); };\n                if (!config_1.config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(wrappedComplete);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n                    this.unsubscribe();\n                }\n            }\n            else {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            this.unsubscribe();\n            if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n                throw err;\n            }\n            else {\n                hostReportError_1.hostReportError(err);\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n        if (!config_1.config.useDeprecatedSynchronousErrorHandling) {\n            throw new Error('bad call');\n        }\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n                parent.syncErrorValue = err;\n                parent.syncErrorThrown = true;\n                return true;\n            }\n            else {\n                hostReportError_1.hostReportError(err);\n                return true;\n            }\n        }\n        return false;\n    };\n    SafeSubscriber.prototype._unsubscribe = function () {\n        var _parentSubscriber = this._parentSubscriber;\n        this._context = null;\n        this._parentSubscriber = null;\n        _parentSubscriber.unsubscribe();\n    };\n    return SafeSubscriber;\n}(Subscriber));\nexports.SafeSubscriber = SafeSubscriber;\n//# sourceMappingURL=Subscriber.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar isArray_1 = require(\"./util/isArray\");\nvar isObject_1 = require(\"./util/isObject\");\nvar isFunction_1 = require(\"./util/isFunction\");\nvar UnsubscriptionError_1 = require(\"./util/UnsubscriptionError\");\nvar Subscription = (function () {\n    function Subscription(unsubscribe) {\n        this.closed = false;\n        this._parentOrParents = null;\n        this._subscriptions = null;\n        if (unsubscribe) {\n            this._ctorUnsubscribe = true;\n            this._unsubscribe = unsubscribe;\n        }\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var errors;\n        if (this.closed) {\n            return;\n        }\n        var _a = this, _parentOrParents = _a._parentOrParents, _ctorUnsubscribe = _a._ctorUnsubscribe, _unsubscribe = _a._unsubscribe, _subscriptions = _a._subscriptions;\n        this.closed = true;\n        this._parentOrParents = null;\n        this._subscriptions = null;\n        if (_parentOrParents instanceof Subscription) {\n            _parentOrParents.remove(this);\n        }\n        else if (_parentOrParents !== null) {\n            for (var index = 0; index < _parentOrParents.length; ++index) {\n                var parent_1 = _parentOrParents[index];\n                parent_1.remove(this);\n            }\n        }\n        if (isFunction_1.isFunction(_unsubscribe)) {\n            if (_ctorUnsubscribe) {\n                this._unsubscribe = undefined;\n            }\n            try {\n                _unsubscribe.call(this);\n            }\n            catch (e) {\n                errors = e instanceof UnsubscriptionError_1.UnsubscriptionError ? flattenUnsubscriptionErrors(e.errors) : [e];\n            }\n        }\n        if (isArray_1.isArray(_subscriptions)) {\n            var index = -1;\n            var len = _subscriptions.length;\n            while (++index < len) {\n                var sub = _subscriptions[index];\n                if (isObject_1.isObject(sub)) {\n                    try {\n                        sub.unsubscribe();\n                    }\n                    catch (e) {\n                        errors = errors || [];\n                        if (e instanceof UnsubscriptionError_1.UnsubscriptionError) {\n                            errors = errors.concat(flattenUnsubscriptionErrors(e.errors));\n                        }\n                        else {\n                            errors.push(e);\n                        }\n                    }\n                }\n            }\n        }\n        if (errors) {\n            throw new UnsubscriptionError_1.UnsubscriptionError(errors);\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var subscription = teardown;\n        if (!teardown) {\n            return Subscription.EMPTY;\n        }\n        switch (typeof teardown) {\n            case 'function':\n                subscription = new Subscription(teardown);\n            case 'object':\n                if (subscription === this || subscription.closed || typeof subscription.unsubscribe !== 'function') {\n                    return subscription;\n                }\n                else if (this.closed) {\n                    subscription.unsubscribe();\n                    return subscription;\n                }\n                else if (!(subscription instanceof Subscription)) {\n                    var tmp = subscription;\n                    subscription = new Subscription();\n                    subscription._subscriptions = [tmp];\n                }\n                break;\n            default: {\n                throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n            }\n        }\n        var _parentOrParents = subscription._parentOrParents;\n        if (_parentOrParents === null) {\n            subscription._parentOrParents = this;\n        }\n        else if (_parentOrParents instanceof Subscription) {\n            if (_parentOrParents === this) {\n                return subscription;\n            }\n            subscription._parentOrParents = [_parentOrParents, this];\n        }\n        else if (_parentOrParents.indexOf(this) === -1) {\n            _parentOrParents.push(this);\n        }\n        else {\n            return subscription;\n        }\n        var subscriptions = this._subscriptions;\n        if (subscriptions === null) {\n            this._subscriptions = [subscription];\n        }\n        else {\n            subscriptions.push(subscription);\n        }\n        return subscription;\n    };\n    Subscription.prototype.remove = function (subscription) {\n        var subscriptions = this._subscriptions;\n        if (subscriptions) {\n            var subscriptionIndex = subscriptions.indexOf(subscription);\n            if (subscriptionIndex !== -1) {\n                subscriptions.splice(subscriptionIndex, 1);\n            }\n        }\n    };\n    Subscription.EMPTY = (function (empty) {\n        empty.closed = true;\n        return empty;\n    }(new Subscription()));\n    return Subscription;\n}());\nexports.Subscription = Subscription;\nfunction flattenUnsubscriptionErrors(errors) {\n    return errors.reduce(function (errs, err) { return errs.concat((err instanceof UnsubscriptionError_1.UnsubscriptionError) ? err.errors : err); }, []);\n}\n//# sourceMappingURL=Subscription.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar _enable_super_gross_mode_that_will_cause_bad_things = false;\nexports.config = {\n    Promise: undefined,\n    set useDeprecatedSynchronousErrorHandling(value) {\n        if (value) {\n            var error = new Error();\n            console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n' + error.stack);\n        }\n        else if (_enable_super_gross_mode_that_will_cause_bad_things) {\n            console.log('RxJS: Back to a better error behavior. Thank you. <3');\n        }\n        _enable_super_gross_mode_that_will_cause_bad_things = value;\n    },\n    get useDeprecatedSynchronousErrorHandling() {\n        return _enable_super_gross_mode_that_will_cause_bad_things;\n    },\n};\n//# sourceMappingURL=config.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexports.getSymbolIterator = getSymbolIterator;\nexports.iterator = getSymbolIterator();\nexports.$$iterator = exports.iterator;\n//# sourceMappingURL=iterator.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.observable = (function () { return typeof Symbol === 'function' && Symbol.observable || '@@observable'; })();\n//# sourceMappingURL=observable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.rxSubscriber = (function () {\n    return typeof Symbol === 'function'\n        ? Symbol('rxSubscriber')\n        : '@@rxSubscriber_' + Math.random();\n})();\nexports.$$rxSubscriber = exports.rxSubscriber;\n//# sourceMappingURL=rxSubscriber.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar UnsubscriptionErrorImpl = (function () {\n    function UnsubscriptionErrorImpl(errors) {\n        Error.call(this);\n        this.message = errors ?\n            errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ') : '';\n        this.name = 'UnsubscriptionError';\n        this.errors = errors;\n        return this;\n    }\n    UnsubscriptionErrorImpl.prototype = Object.create(Error.prototype);\n    return UnsubscriptionErrorImpl;\n})();\nexports.UnsubscriptionError = UnsubscriptionErrorImpl;\n//# sourceMappingURL=UnsubscriptionError.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"../Subscriber\");\nfunction canReportError(observer) {\n    while (observer) {\n        var _a = observer, closed_1 = _a.closed, destination = _a.destination, isStopped = _a.isStopped;\n        if (closed_1 || isStopped) {\n            return false;\n        }\n        else if (destination && destination instanceof Subscriber_1.Subscriber) {\n            observer = destination;\n        }\n        else {\n            observer = null;\n        }\n    }\n    return true;\n}\nexports.canReportError = canReportError;\n//# sourceMappingURL=canReportError.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction hostReportError(err) {\n    setTimeout(function () { throw err; }, 0);\n}\nexports.hostReportError = hostReportError;\n//# sourceMappingURL=hostReportError.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction identity(x) {\n    return x;\n}\nexports.identity = identity;\n//# sourceMappingURL=identity.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isArray = (function () { return Array.isArray || (function (x) { return x && typeof x.length === 'number'; }); })();\n//# sourceMappingURL=isArray.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isFunction(x) {\n    return typeof x === 'function';\n}\nexports.isFunction = isFunction;\n//# sourceMappingURL=isFunction.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isObject(x) {\n    return x !== null && typeof x === 'object';\n}\nexports.isObject = isObject;\n//# sourceMappingURL=isObject.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction isPromise(value) {\n    return !!value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\nexports.isPromise = isPromise;\n//# sourceMappingURL=isPromise.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar identity_1 = require(\"./identity\");\nfunction pipe() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i] = arguments[_i];\n    }\n    return pipeFromArray(fns);\n}\nexports.pipe = pipe;\nfunction pipeFromArray(fns) {\n    if (fns.length === 0) {\n        return identity_1.identity;\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return function piped(input) {\n        return fns.reduce(function (prev, fn) { return fn(prev); }, input);\n    };\n}\nexports.pipeFromArray = pipeFromArray;\n//# sourceMappingURL=pipe.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar subscribeToArray_1 = require(\"./subscribeToArray\");\nvar subscribeToPromise_1 = require(\"./subscribeToPromise\");\nvar subscribeToIterable_1 = require(\"./subscribeToIterable\");\nvar subscribeToObservable_1 = require(\"./subscribeToObservable\");\nvar isArrayLike_1 = require(\"./isArrayLike\");\nvar isPromise_1 = require(\"./isPromise\");\nvar isObject_1 = require(\"./isObject\");\nvar iterator_1 = require(\"../symbol/iterator\");\nvar observable_1 = require(\"../symbol/observable\");\nexports.subscribeTo = function (result) {\n    if (!!result && typeof result[observable_1.observable] === 'function') {\n        return subscribeToObservable_1.subscribeToObservable(result);\n    }\n    else if (isArrayLike_1.isArrayLike(result)) {\n        return subscribeToArray_1.subscribeToArray(result);\n    }\n    else if (isPromise_1.isPromise(result)) {\n        return subscribeToPromise_1.subscribeToPromise(result);\n    }\n    else if (!!result && typeof result[iterator_1.iterator] === 'function') {\n        return subscribeToIterable_1.subscribeToIterable(result);\n    }\n    else {\n        var value = isObject_1.isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n        var msg = \"You provided \" + value + \" where a stream was expected.\"\n            + ' You can provide an Observable, Promise, Array, or Iterable.';\n        throw new TypeError(msg);\n    }\n};\n//# sourceMappingURL=subscribeTo.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.subscribeToArray = function (array) { return function (subscriber) {\n    for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n        subscriber.next(array[i]);\n    }\n    subscriber.complete();\n}; };\n//# sourceMappingURL=subscribeToArray.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar iterator_1 = require(\"../symbol/iterator\");\nexports.subscribeToIterable = function (iterable) { return function (subscriber) {\n    var iterator = iterable[iterator_1.iterator]();\n    do {\n        var item = void 0;\n        try {\n            item = iterator.next();\n        }\n        catch (err) {\n            subscriber.error(err);\n            return subscriber;\n        }\n        if (item.done) {\n            subscriber.complete();\n            break;\n        }\n        subscriber.next(item.value);\n        if (subscriber.closed) {\n            break;\n        }\n    } while (true);\n    if (typeof iterator.return === 'function') {\n        subscriber.add(function () {\n            if (iterator.return) {\n                iterator.return();\n            }\n        });\n    }\n    return subscriber;\n}; };\n//# sourceMappingURL=subscribeToIterable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar observable_1 = require(\"../symbol/observable\");\nexports.subscribeToObservable = function (obj) { return function (subscriber) {\n    var obs = obj[observable_1.observable]();\n    if (typeof obs.subscribe !== 'function') {\n        throw new TypeError('Provided object does not correctly implement Symbol.observable');\n    }\n    else {\n        return obs.subscribe(subscriber);\n    }\n}; };\n//# sourceMappingURL=subscribeToObservable.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar hostReportError_1 = require(\"./hostReportError\");\nexports.subscribeToPromise = function (promise) { return function (subscriber) {\n    promise.then(function (value) {\n        if (!subscriber.closed) {\n            subscriber.next(value);\n            subscriber.complete();\n        }\n    }, function (err) { return subscriber.error(err); })\n        .then(null, hostReportError_1.hostReportError);\n    return subscriber;\n}; };\n//# sourceMappingURL=subscribeToPromise.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar InnerSubscriber_1 = require(\"../InnerSubscriber\");\nvar subscribeTo_1 = require(\"./subscribeTo\");\nvar Observable_1 = require(\"../Observable\");\nfunction subscribeToResult(outerSubscriber, result, outerValue, outerIndex, innerSubscriber) {\n    if (innerSubscriber === void 0) { innerSubscriber = new InnerSubscriber_1.InnerSubscriber(outerSubscriber, outerValue, outerIndex); }\n    if (innerSubscriber.closed) {\n        return undefined;\n    }\n    if (result instanceof Observable_1.Observable) {\n        return result.subscribe(innerSubscriber);\n    }\n    return subscribeTo_1.subscribeTo(result)(innerSubscriber);\n}\nexports.subscribeToResult = subscribeToResult;\n//# sourceMappingURL=subscribeToResult.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Subscriber_1 = require(\"../Subscriber\");\nvar rxSubscriber_1 = require(\"../symbol/rxSubscriber\");\nvar Observer_1 = require(\"../Observer\");\nfunction toSubscriber(nextOrObserver, error, complete) {\n    if (nextOrObserver) {\n        if (nextOrObserver instanceof Subscriber_1.Subscriber) {\n            return nextOrObserver;\n        }\n        if (nextOrObserver[rxSubscriber_1.rxSubscriber]) {\n            return nextOrObserver[rxSubscriber_1.rxSubscriber]();\n        }\n    }\n    if (!nextOrObserver && !error && !complete) {\n        return new Subscriber_1.Subscriber(Observer_1.empty);\n    }\n    return new Subscriber_1.Subscriber(nextOrObserver, error, complete);\n}\nexports.toSubscriber = toSubscriber;\n//# sourceMappingURL=toSubscriber.js.map","export * from './rxvalue';\n//# sourceMappingURL=index.js.map","import { combineLatest, of as rxof, Observable } from 'rxjs';\nimport { distinctUntilChanged as rxdistinct, map as rxmap } from 'rxjs/operators';\nexport const of = (value) => Object.assign(rxof(value), { value });\nexport function map(p, thisArg, valued) {\n    const map = rxmap(p, thisArg);\n    return valued ? (source) => {\n        const obs = map(source);\n        return Object.defineProperty(obs, 'value', { get: () => p.call(thisArg, source.value, -1) });\n    } : map;\n}\nexport function distinctUntilChanged(compare, keySelector, valued) {\n    const op = compare && keySelector ? rxdistinct(compare, keySelector) : rxdistinct(compare);\n    return valued ? (source) => {\n        const obs = source.pipe(op);\n        return Object.defineProperty(obs, 'value', { get: () => source.value });\n    } : op;\n}\nexport const combine = (sources) => Object.defineProperty(combineLatest(sources), 'value', { get: () => sources.map(s => s.value) });\nexport const idem = (op) => (o) => Object.defineProperty(o.pipe(op), 'value', { get: () => o.value });\nexport const fromPromise = (p, value) => {\n    const observable = new Observable(subs => {\n        let done = false;\n        subs.next(value);\n        p.then(v => {\n            if (!done)\n                subs.next(value = v);\n            subs.complete();\n        }, err => subs.error(err));\n        return () => { done = true; };\n    });\n    return Object.defineProperty(observable, 'value', () => value);\n};\n//# sourceMappingURL=rxvalue.js.map","export type Rec<K extends keyof any> = Partial<Record<K, any>>;\r\nexport type TRec<K extends keyof any, KK extends Record<K, keyof any>> = { [k in K]: Record<KK[k], any> };\r\n\r\nexport type PromiseCtr = {\r\n  new <T>(executor: (resolve: (value?: T | PromiseLike<T>) => void, reject: (reason?: any) => void, onCancel?: (callback: () => void) => void) => void): PromiseLike<T>;\r\n  all<T>(values: readonly (T | PromiseLike<T>)[]): PromiseLike<T[]>,\r\n  resolve<T>(value: T | PromiseLike<T>): PromiseLike<T>;\r\n  reject<T = never>(reason?: any): PromiseLike<T>;\r\n}\r\n\r\nexport const runit = <R, N>(gen: Generator<N | PromiseLike<N>, R, N>, promiseCtr: PromiseCtr) => {\r\n  const runThen = (...args: [] | [N]): PromiseLike<R> => {\r\n    const v = args.length ? gen.next(args[0]) : gen.next();\r\n    if (v.done) return promiseCtr.resolve(v.value);\r\n    return promiseCtr.resolve(v.value).then(runThen);\r\n  }; return runThen();\r\n}\r\n\r\nexport function* wait<T>(x: T | PromiseLike<T>): Generator<T | PromiseLike<T>, T, T> {\r\n  return yield x;\r\n}\r\n\r\nexport function asAsync<T extends any[], R, U = void, N = any>(f: (this: U, ...args: T) => Generator<N | PromiseLike<N>, R, N>, promiseCtr: PromiseCtr, thisArg: U): (...args: T) => PromiseLike<R>;\r\nexport function asAsync<T extends any[], R, U = void, N = any>(f: (this: U | void, ...args: T) => Generator<N | PromiseLike<N>, R, N>, promiseCtr: PromiseCtr, thisArg?: U): (...args: T) => PromiseLike<R>;\r\nexport function asAsync<T extends any[], R, U = void, N = any>(f: (this: U, ...args: T) => Generator<N | PromiseLike<N>, R, N>, promiseCtr: PromiseCtr, thisArg: U): (...args: T) => PromiseLike<R> {\r\n  return (...args: T) => runit(f.call(thisArg, ...args as T), promiseCtr);\r\n}\r\n\r\n\r\n\r\nexport const guard = <T, V extends T>(x: T, cond: boolean): x is V => cond;\r\nexport class Keys<K extends string | symbol | number> {\r\n  readonly keys: K[];\r\n  private _!: { [k in K]: null };\r\n  constructor(o: { [k in K]: any }) { this.keys = Object.keys(o)/*.sort()*/ as K[]; }\r\n  mapTo<V extends { [k in K]: any }>(mapper: <k extends K>(k: k, i: number) => V[k]): Pick<V, K> {\r\n    const object = {} as Pick<V, K>;\r\n    this.keys.forEach((k, i) => object[k] = mapper(k, i));\r\n    return object;\r\n  }\r\n  asyncMapTo<V extends { [k in K]: any }>(mapper: <k extends K>(k: k) => PromiseLike<V[k]>, promiseCtr: PromiseCtr): PromiseLike<Pick<V, K>> {\r\n    const object = {} as Pick<V, K>;\r\n    return promiseCtr.all(this.keys.map(k => mapper(k).then(v => object[k] = v))).then(() => object);\r\n  }\r\n}\r\n","import { Rec } from '..';\r\nimport { ValuedSubject, of } from 'rxvalue';\r\n\r\n\r\n/** \r\n * Entity base class\r\n * @template T map of fields output types\r\n * @template V map of fields input types\r\n */\r\nexport abstract class EntityAbstract<K extends string, T extends Rec<K>, V extends T> {\r\n  /** `function` that returns the `ValuedSubject` for the givin `field` */\r\n  abstract readonly rx: EntityFieldsFct<K, T, V>;\r\n  /** `map` that stores the `ValuedSubject` for all the entity `fields` */\r\n  abstract readonly rxMap: Readonly<EntityFieldsMap<K, T, V>>;\r\n  /** a `getter` snapshot for the *local* `fields` */\r\n  abstract readonly local: Partial<Pick<T, K>>;\r\n\r\n  /** a `getter` snapshot for all the entity `fields` */\r\n  get snapshot() {\r\n    const snapshot = {} as Pick<T, K>;\r\n    const rx = this.rx;\r\n    for (const k of Object.keys(this.rxMap) as K[]) {\r\n      snapshot[k] = rx(k).value;\r\n    }\r\n    return snapshot;\r\n  }\r\n\r\n  /** updates some fields of the entity */\r\n  readonly update = <SK extends K>(e: { [k in SK]: V[k] }) => {\r\n    const rx = this.rx;\r\n    (Object.keys(e) as SK[]).forEach(<k extends SK>(k: k) => {\r\n      rx(k).next(e[k]);\r\n    });\r\n  };\r\n\r\n  /** undo local changes in the entity */\r\n  readonly rewind = <SK extends K>(_field?: SK) => { };\r\n\r\n  /** define the parent of the entity */\r\n  readonly setParent = () => { };\r\n\r\n  /** get the number of entities between the actual and the source of the field */\r\n  readonly levelOf = <SK extends K>(_field: SK) => of(0);\r\n}\r\n\r\n/** `function` that associates to each key of an entity a `ValuedSubject` */\r\nexport type EntityFieldsFct<K extends string, T extends Rec<K>, V extends T = T> = {\r\n  <k extends K>(k: k): ValuedSubject<T[k], V[k]>;\r\n};\r\n\r\n/** `map` that associates to each key of an entity a `ValuedSubject` */\r\nexport type EntityFieldsMap<K extends string, T extends Rec<K>, V extends T = T> = {\r\n  [k in K]: ValuedSubject<T[k], V[k]>\r\n};\r\n\r\n","import { BehaviorSubject, identity } from \"rxjs\";\r\nimport { EntityFieldsFct, EntityFieldsMap, EntityAbstract } from \"./entity-abstract\";\r\nimport { ValuedSubject, map, of, ValuedObservable } from \"rxvalue\";\r\nimport { Entity, $rx, $rxMap, $levelOf } from \"./entity-proxies\";\r\nimport { guard, Rec } from \"../common\";\r\nimport { alternMap } from \"altern-map\";\r\n\r\n/** \r\n * Child entity class\r\n * @template T map of fields output types\r\n * @template P map of fields parent output types\r\n * @template V map of fields input types\r\n * @template I union of initial field keys\r\n */\r\nexport class ChildEntityImpl<K extends string, T extends Rec<K>, V extends T, P extends T, pimpl extends EntityAbstract<K, P, any> = EntityAbstract<K, P, any>> extends EntityAbstract<K, T, V> {\r\n  readonly rx: EntityFieldsFct<K, T, V> = <k extends K>(k: k) => {\r\n    return this.rxMap[k] || (this.rxMap[k] = this.createRx(k));\r\n  };\r\n  private createRx<k extends K>(k: k): ValuedSubject<T[k], V[k]> {\r\n    const rxSource: ValuedSubject<ValuedSubject<T[k], V[k]>> = this.rxSource(k);\r\n    const zz = alternMap<ValuedObservable<T[k]>, T[k]>(identity, {}, true);\r\n    return Object.assign(rxSource.pipe(zz), {\r\n      next: (x: V[k]) => this._parent && rxSource.value === $rx(this._parent, k)\r\n        ? rxSource.next(new BehaviorSubject<T[k]>(x))\r\n        : rxSource.value.next(x)\r\n    });\r\n  }\r\n  readonly rxMap: EntityFieldsMap<K, T, V>;\r\n  private rxSource = <k extends K>(k: k) => {\r\n    return this.rxSourceMap[k] || (\r\n      this.rxSourceMap[k] = new BehaviorSubject<ValuedSubject<T[k], V[k]>>(this._parent\r\n        ? $rx(this._parent, k)\r\n        : new BehaviorSubject<V[k]>(undefined as any)\r\n      )\r\n    );\r\n  };\r\n  private rxSourceMap: { [k in keyof T]: BehaviorSubject<ValuedSubject<T[k], V[k]>> };\r\n  private _parent: Entity<K, P, any, pimpl> | undefined = undefined;\r\n  get parent() { return this._parent; };\r\n\r\n  get local() {\r\n    if (!this._parent) return this.snapshot;\r\n    const parent = this._parent;\r\n    const snapshot: Partial<Pick<T, K>> = {};\r\n    const rxSourceMap = this.rxSourceMap;\r\n    for (const k of Object.keys(rxSourceMap) as K[]) {\r\n      const source = rxSourceMap[k].value;\r\n      if (source !== $rxMap(parent)[k]) snapshot[k] = source.value;\r\n    }\r\n    return snapshot;\r\n  }\r\n\r\n  constructor(params: {\r\n    data: V;\r\n    parentPromise: { then: (setParent: (parent: Entity<K, P, any, pimpl>) => void) => void; };\r\n    ready: false;\r\n  } | {\r\n    data: { [k in K]?: V[k] };\r\n    parent: Entity<K, P, any, pimpl>;\r\n    ready: true;\r\n  }) {\r\n    super();\r\n    const rxMap = this.rxMap = {} as EntityFieldsMap<K, T, V>;\r\n    const rxSourceMap = this.rxSourceMap = {} as { [k in keyof T]: BehaviorSubject<ValuedSubject<T[k], V[k]>> };\r\n    let keys: K[];\r\n    if (params.ready) {\r\n      const { data, parent } = params;\r\n      this._parent = parent;\r\n      keys = Object.keys($rxMap(parent)) as K[];\r\n      keys.forEach(<k extends K>(k: k) => {\r\n        const next: ValuedSubject<T[k], V[k]> = k in data\r\n          ? new BehaviorSubject(data[k] as V[k])\r\n          : $rx(parent, k);\r\n        rxSourceMap[k] = new BehaviorSubject(next);\r\n      });\r\n    } else {\r\n      const { data, parentPromise } = params;\r\n      keys = Object.keys(data) as K[];\r\n      parentPromise.then(this.setParent);\r\n      keys.forEach(<k extends keyof T>(k: k) => {\r\n        rxSourceMap[k] = new BehaviorSubject<ValuedSubject<T[k], V[k]>>(new BehaviorSubject(data[k] as T[k]));\r\n      });\r\n    }\r\n    keys.forEach(<k extends K>(k: k) => rxMap[k] = this.createRx(k));\r\n  }\r\n\r\n  setParent = (parent?: Entity<K, P, any, pimpl>) => {\r\n    const oldParent = this.parent;\r\n    this._parent = parent;\r\n    const rxSourceMap = this.rxSourceMap;\r\n    if (parent) (Object.keys(rxSourceMap) as K[]).forEach(<k extends K>(k: k) => {\r\n      if (rxSourceMap[k].value === undefined) {\r\n        rxSourceMap[k].next($rx(parent, k));\r\n      }\r\n    });\r\n    if (!oldParent) return;\r\n    (Object.keys($rxMap(oldParent)) as K[]).forEach(<k extends K>(k: k) => {\r\n      if (rxSourceMap[k]?.value === $rxMap(oldParent)[k]) {\r\n        if (parent) rxSourceMap[k].next($rx(parent, k));\r\n        else {\r\n          rxSourceMap[k].next(new BehaviorSubject<T[k]>($rxMap(oldParent)[k].value));\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  readonly rewind = <SK extends K>(field?: SK) => {\r\n    const parent = this._parent;\r\n    if (!parent) return;\r\n    (field ? [field] : Object.keys(this.rxSourceMap) as SK[]).forEach(\r\n      field => this.rxSource(field).next($rx(parent, field))\r\n    );\r\n  };\r\n\r\n  readonly levelOf = <SK extends K>(field: SK) => this.rxSource(field).pipe(alternMap(\r\n    (src: unknown) => src === this._parent?.[field] ? $levelOf(this._parent!, field).pipe(map(l => l + 1, 0, true)) : of(0),\r\n    {}, true\r\n  ));\r\n}\r\n","import { BehaviorSubject } from \"rxjs\";\r\nimport { Rec } from \"..\";\r\nimport { EntityAbstract, EntityFieldsFct, EntityFieldsMap } from \"./entity-abstract\";\r\n\r\n/** \r\n * Top level entity class\r\n * @template T map of fields output types\r\n * @template V map of fields input types\r\n */\r\nexport class EntityImpl<K extends string, T extends Rec<K>, V extends T> extends EntityAbstract<K, T, V> {\r\n  readonly rx: EntityFieldsFct<K, T, V> = <k extends K>(k: k) => {\r\n    return this.rxMap[k] || (this.rxMap[k] = new BehaviorSubject<V[k]>(undefined as any));\r\n  };\r\n  readonly rxMap: EntityFieldsMap<K, T, V>;\r\n  get local() { return this.snapshot; }\r\n  constructor(e: V) {\r\n    super();\r\n    const rxMap = this.rxMap = {} as EntityFieldsMap<K, V>;\r\n    (Object.keys(e) as K[]).forEach(k => {\r\n      rxMap[k] = new BehaviorSubject(e[k])\r\n    })\r\n  }\r\n};\r\n","import { alternMap } from \"altern-map\";\r\nimport { Observable } from \"rxjs\";\r\nimport { EntityAbstract } from \"./entity-abstract\";\r\nimport { ValuedSubject } from \"rxvalue\";\r\nimport { Rec } from \"../common\";\r\n\r\ndeclare const $entity: unique symbol;\r\nconst entities = new WeakMap<Entity<any, any, any>, EntityAbstract<any, any, any>>();\r\n/** \r\n * Proxified entity type\r\n * @template T map of fields output types\r\n * @template V map of fields input types\r\n */\r\nexport type Entity<K extends string, T extends Rec<K>, V extends T, E extends EntityAbstract<K, T, V> = EntityAbstract<K, T, V>> = { readonly [$entity]: E, } & {\r\n  readonly [k in K]: ValuedSubject<T[k], V[k]>\r\n};\r\n\r\nexport function getEntity<K extends string, T extends Rec<K>, V extends T, E extends EntityAbstract<K, T, V>>(e: Entity<K, T, V, E>): E;\r\nexport function getEntity<K extends string, T extends Rec<K>, V extends T, E extends EntityAbstract<K, T, V>>(e: Entity<K, T, V, E> | undefined): E | undefined;\r\nexport function getEntity<K extends string, T extends Rec<K>, V extends T, E extends EntityAbstract<K, T, V>>(e?: Entity<K, T, V, E>): E | undefined {\r\n  if (!e) return;\r\n  return entities.get(e) as E;\r\n}\r\n\r\n/** \r\n * Proxified entity observable, subscribing to it keeps entity in the store\r\n * @template T map of fields output types\r\n * @template V map of fields input types\r\n */\r\nexport type EntityFlow<K extends string, T extends Rec<K>, V extends T, E extends EntityAbstract<K, T, V> = EntityAbstract<K, T, V>> = {\r\n  readonly [k in Exclude<K, 'observable' | 'field' | 'unsubscribe'>]: Observable<T[k]>;\r\n} & {\r\n  observable: Observable<Entity<K, T, V, E>>;\r\n  field: { readonly [k in K]: Observable<T[k]> };\r\n};\r\n\r\n/** Extracts the field observable from the entity flow */\r\nconst fieldRX = <K extends string, T extends Rec<K>, V extends T, k extends K>(entity: Observable<Entity<K, T, V>>, field: k): Observable<T[k]> => {\r\n  return entity.pipe(alternMap(e => getEntity(e).rx(field)));\r\n};\r\n\r\n/** \r\n * Creates an `EntityFlow` from an observable\r\n * @param observable the observable being proxified\r\n * @param {Record<Observable>} [field] optional external impl of the field observables proxy\r\n * @see {EntityFlow}\r\n */\r\nexport const entityFlow = <K extends string, T extends Rec<K>, V extends T, E extends EntityAbstract<K, T, V> = EntityAbstract<K, T, V>>(\r\n  observable: Observable<Entity<K, T, V, E>>,\r\n  field?: EntityFlow<K, T, V, E>['field']\r\n): EntityFlow<K, T, V, E> => new Proxy({} as any as EntityFlow<K, T, V, E>, {\r\n  get(_target: EntityFlow<K, T, V, E>, key: keyof EntityFlow<K, T, V, E>) {\r\n    if (key === 'observable') return observable;\r\n    if (key === 'field') return field || (field = new Proxy({} as EntityFlow<K, T, V>['field'], {\r\n      get<k extends K>(_: EntityFlow<K, T, V>['field'], k: k) { return fieldRX(observable, k); }\r\n    }));\r\n    return fieldRX(observable, key);\r\n  }\r\n});\r\n\r\n\r\n/** \r\n * Creates a proxified `Entity` from an `EntityAbstract`\r\n * @see {Entity}\r\n */\r\nexport const toEntity = <K extends string, T extends Rec<K>, V extends T, E extends EntityAbstract<K, T, V>>(entity: EntityAbstract<K, T, V> & E) => {\r\n  const proxy = new Proxy<Entity<K, T, V, E>>(Object.prototype as Entity<K, T, V, E>, {\r\n    get(_, key: K) {\r\n      return entity.rx(key);\r\n    },\r\n    ownKeys() {\r\n      return Object.keys(entity.rxMap)\r\n    }\r\n  });\r\n  entities.set(proxy, entity);\r\n  return proxy;\r\n};\r\n\r\n\r\nexport const $rx = <K extends string, T extends Rec<K>, V extends T, k extends K>(entity: Entity<K, T, V>, k: k) => getEntity(entity).rx(k);\r\nexport const $rxMap = <K extends string, T extends Rec<K>, V extends T>(entity: Entity<K, T, V>) => getEntity(entity).rxMap;\r\nexport const $levelOf = <K extends string, T extends Rec<K>, V extends T, k extends K>(entity: Entity<K, T, V>, k: k) => getEntity(entity).levelOf(k);\r\nexport const $rewind = <K extends string, T extends Rec<K>, V extends T, k extends K>(entity: Entity<K, T, V>, k?: k) => getEntity(entity).rewind(k);\r\nexport const $update = <K extends string, T extends Rec<K>, V extends T, SK extends K>(entity: Entity<K, T, V>, e: { [k in SK]: V[k] }) => getEntity(entity).update(e);\r\nexport const $snapshot = <K extends string, T extends Rec<K>, V extends T>(entity: Entity<K, T, V>) => getEntity(entity).snapshot;\r\nexport const $local = <K extends string, T extends Rec<K>, V extends T>(entity: Entity<K, T, V>) => getEntity(entity).local;\r\n\r\n","export * from './entity-abstract';\r\nexport * from './entity-child-impl';\r\nexport * from './entity-impl';\r\nexport * from './entity-proxies';\r\n","export * from './entity';\r\nexport * from './list';\r\nexport * from './common';\r\nexport * from './store';\r\n","export * from './stored-list';\r\nexport * from './types';","import { Subscription, Observable, Subscriber, ReplaySubject, from } from 'rxjs';\r\nimport { shareReplay } from 'rxjs/operators';\r\nimport { Entity, EntityAbstract, EntityImpl } from '../entity';\r\nimport { Entities, EntitiesFlow, ListStatus, EntityList, AbstractEntities, AbstractStores, EntitiesImpl, TopStores, ChildEntitiesImpl, ChildStores } from './types';\r\nimport { asAsync, Keys, PromiseCtr, TRec, wait } from '../common'\r\n\r\ntype EntityWithSubscrition<K extends string, KK extends Record<K, string>, T extends TRec<K, KK>, V extends T, impl extends AbstractEntities<K, KK, T, V> = AbstractEntities<K, KK, T, V>> = { entity: Entities<K, KK, T, V, impl>, subscription: Subscription; };\r\n\r\nexport type Params<K extends string, ID extends Pick<any, K>, key extends K, KK extends Record<K, string>, T extends TRec<K, KK>, V extends T, impl extends AbstractEntities<K, KK, T, V>, stores extends AbstractStores<K, ID, KK, T, V, impl>> = {\r\n  /** \r\n   * Retrieve function\r\n   * @returns {PromiseLike<{ done?: boolean, data: V[]; }>} `done` is undefined means information is not available, check parent\r\n   */\r\n  retrieve: (first?: Entities<K, KK, T, V, impl>, last?: Entities<K, KK, T, V, impl>) => PromiseLike<{ done?: boolean, data: V[]; }>,\r\n  stores: stores,\r\n  key: key,\r\n  keyof: <k extends K>(k: k, data: V[k]) => ID[k],\r\n  keyofEntity: <k extends K>(k: k, data: Entity<KK[k], T[k], any>) => ID[k],\r\n  merge: (key: key, list1: EntityWithSubscrition<K, KK, T, V, impl>[], list2: EntityWithSubscrition<K, KK, T, V, impl>[]) => EntityWithSubscrition<K, KK, T, V, impl>[],\r\n  promiseCtr: PromiseCtr,\r\n};\r\n\r\n\r\nexport abstract class AbstractStoredList<K extends string, ID extends Pick<any, K>, KK extends Record<K, string>,\r\n  key extends K, T extends TRec<K, KK>, V extends T, impl extends AbstractEntities<K, KK, T, V>,\r\n  stores extends AbstractStores<K, ID, KK, T, V, impl>,\r\n  > implements EntityList<K, ID, KK, T, V, impl> {\r\n  protected parentSubsctiption?: Subscription;\r\n  private retrieve: (first?: Entities<K, KK, T, V, impl>, last?: Entities<K, KK, T, V, impl>, err?: any) => PromiseLike<{ done?: boolean, data: Pick<V, K>[]; }>;\r\n  /** list is null when `entities` has no subscription */\r\n  protected list: { data: EntityWithSubscrition<K, KK, T, V, impl>[], status: ListStatus; } | null = null;\r\n  protected subscriber: Subscriber<{ list: Entities<K, KK, T, V, impl>[], status: ListStatus; }> | null = null;\r\n  private donePromises: (PromiseLike<ListStatus> | undefined)[] = [];\r\n  readonly key: key;\r\n  readonly merge: (key: key, list1: EntityWithSubscrition<K, KK, T, V, impl>[], list2: EntityWithSubscrition<K, KK, T, V, impl>[]) => EntityWithSubscrition<K, KK, T, V, impl>[];\r\n  readonly keys: Keys<K>;\r\n  readonly stores: stores;\r\n  readonly keyof: <k extends K>(k: k, data: V[k]) => ID[k];\r\n  readonly keyofEntity: <k extends K>(k: k, data: Entity<KK[k], T[k], any>) => ID[k];\r\n  readonly promiseCtr: PromiseCtr;\r\n  /**\r\n   * @param {Params} params \r\n   */\r\n  constructor(params: Params<K, ID, key, KK, T, V, impl, stores>) {\r\n    const { key, merge, retrieve, keyof, keyofEntity, stores, promiseCtr } = params;\r\n    this.keyof = keyof;\r\n    this.keyofEntity = keyofEntity;\r\n    this.stores = stores;\r\n    this.keys = new Keys(stores);\r\n    this.retrieve = retrieve;\r\n    this.key = key;\r\n    this.merge = merge;\r\n    this.promiseCtr = promiseCtr;\r\n  }\r\n\r\n  add(entity: Entities<K, KK, T, V, impl>) {\r\n    const key = this.key;\r\n    const id = this.keyofEntity(key, entity[key]);\r\n    if (this.list === null || this.list.data.find(e => this.keyofEntity(key, e.entity[key]) === id)) return;\r\n    const subscription = new Subscription();\r\n    const stores = this.stores;\r\n    new Keys<K>(entity).keys.forEach(k => {\r\n      const obs = stores[k].get(id).observable;\r\n      subscription.add(obs.subscribe());\r\n    });\r\n    this.list = { data: [{ entity, subscription }, ...this.list.data], status: this.list.status };\r\n    this.subscriber?.next({ list: this.list.data.map(e => e.entity), status: this.list.status });\r\n  }\r\n\r\n  remove(entity: Entities<K, KK, T, V, impl>) {\r\n    if (this.list === null) return;\r\n    const index = this.list.data.findIndex(e => e.entity === entity);\r\n    if (index !== -1) {\r\n      const list = this.list;\r\n      list.data[index].subscription.unsubscribe();\r\n      list.data.splice(index, 1);\r\n      this.subscriber?.next({ list: list.data.map(e => e.entity), status: list.status });\r\n    }\r\n  }\r\n\r\n  protected toPromise(flowList: EntitiesFlow<K, KK, T, V, impl>[]): PromiseLike<EntityWithSubscrition<K, KK, T, V, impl>[]> {\r\n    const entitiesWithSubs: PromiseLike<EntityWithSubscrition<K, KK, T, V, impl>>[] = flowList.map(\r\n      asAsync(function* (entitiesFlow) {\r\n        const subscription = new Subscription();\r\n        const entity = this.keys.asyncMapTo<{ [k in K]: Entity<KK[k], T[k], V[k], impl[k] & EntityAbstract<KK[k], T[k], V[k]>> }>(\r\n          <k extends K>(k: k) => new this.promiseCtr<Entity<KK[k], T[k], V[k], impl[k] & EntityAbstract<KK[k], T[k], V[k]>>>(\r\n            res => entitiesFlow[k].observable.subscribe(res)\r\n          ), this.promiseCtr\r\n        );\r\n        return yield* wait(entity.then((entity) => ({ subscription, entity })));\r\n      }, this.promiseCtr, this)\r\n    );\r\n    return this.promiseCtr.all(entitiesWithSubs);\r\n  }\r\n\r\n  protected _status(child: ListStatus, parent: ListStatus) {\r\n    return child === null ? null : child ?? parent;\r\n  }\r\n\r\n  readonly entities = new Observable<{ list: Entities<K, KK, T, V, impl>[], status: ListStatus; }>(subscriber => {\r\n    this.list = { data: [], status: undefined };\r\n    this.subscriber = subscriber;\r\n    this.reload();\r\n    return () => {\r\n      this.parentSubsctiption?.unsubscribe();\r\n      this.parentSubsctiption = undefined;\r\n      this.subscriber = null;\r\n      this.list?.data.forEach(e => e.subscription.unsubscribe());\r\n      this.list = null;\r\n    };\r\n  }).pipe(shareReplay({ bufferSize: 1, refCount: true }));\r\n\r\n  private _populate(retrieved: Pick<V, K>[]): PromiseLike<EntityWithSubscrition<K, KK, T, V, impl>[]> {\r\n    const flowList = retrieved.map(p => this.keys.mapTo(k => this.stores[k].get(this.keyof(k, p[k]))));\r\n    const entitiesPromise = this.toPromise(flowList);\r\n    this.keys.keys.forEach(k => this.stores[k].nextBulk(retrieved.map(p => ({ id: this.keyof(k, p[k]), data: p[k] }))));\r\n    return entitiesPromise;\r\n  }\r\n\r\n  reload(err?: any): PromiseLike<ListStatus> {\r\n    return this.exec(0, err);\r\n  }\r\n  more(err?: any): PromiseLike<ListStatus> {\r\n    return this.exec(1, err);\r\n  }\r\n\r\n  private _setDone<V>(n: number, done: PromiseLike<ListStatus>[], v: V | null): v is V {\r\n    if (v === null) {\r\n      done[0] = this.promiseCtr.resolve(true);\r\n      return false;\r\n    }\r\n    if (n > 0) {\r\n      const prev = this.donePromises[n - 1];\r\n      if (prev) {\r\n        done[0] = prev;\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  exec(n: number, err: any, from?: Entities<K, KK, T, V, impl>, to?: Entities<K, KK, T, V, impl>): PromiseLike<ListStatus> {\r\n    return (this.donePromises[n] || (this.donePromises[n] = this._exec(n, err, from, to)));\r\n  }\r\n\r\n  private _exec = (n: number, err: any, from?: Entities<K, KK, T, V, impl>, to?: Entities<K, KK, T, V, impl>): PromiseLike<ListStatus> => asAsync(function* () {\r\n    let done: PromiseLike<ListStatus>[] = [];\r\n    try {\r\n      if (!this._setDone(n, done, this.list)) return yield* wait(done[0]);\r\n      const oldList = n ? this.list.data : [];\r\n      [from, to] = [from || oldList[0]?.entity, to || oldList[oldList.length - 1]?.entity];\r\n      const retrieved = yield* wait(this.retrieve(from, to, err));\r\n      if (!this._setDone(n, done, this.list)) return yield* wait(done[0]);\r\n      const list = yield* wait(this._populate(retrieved.data));\r\n      if (!this._setDone(n, done, this.list)) return yield* wait(done[0]);\r\n      // if reload, unsubscribe from old entities\r\n      if (!n) this.list.data.forEach(e => e.subscription.unsubscribe());\r\n      this.list = { data: oldList.concat(list), status: retrieved.done };\r\n      const process = () => {\r\n        if (!this.list) throw new Error('Unexpected state');\r\n        this.subscriber!.next({ list: this.list.data.map(e => e.entity), status: this.list.status });\r\n        return retrieved.done;\r\n      }\r\n      return retrieved.done === undefined ? yield* this.fromParent(n, process) : process();\r\n    } catch (e) {\r\n      if (!this._setDone(n, done, this.list)) return yield* wait(done[0]);\r\n      this.list.status = null;\r\n      return yield* this.handleError(n, e);\r\n    } finally {\r\n      this.donePromises[n] = undefined;\r\n    }\r\n  }, this.promiseCtr, this)();\r\n  abstract fromParent(n: number, process: () => boolean | undefined): Generator<any, ListStatus, any>;\r\n  abstract handleError(n: number, error: any): Generator<any, ListStatus, any>;\r\n}\r\nexport class TopStoredList<K extends string, ID extends Pick<any, K>, KK extends Record<K, string>,\r\n  key extends K, T extends TRec<K, KK>, V extends T = T> extends AbstractStoredList<K, ID, KK, key, T, V, EntitiesImpl<K, KK, T, V>, TopStores<K, ID, KK, T, V>> {\r\n  *handleError(_n: number, e: any): Generator<never, ListStatus, unknown> { throw e; }\r\n  *fromParent(_n: number, process: () => boolean | undefined): Generator<any, ListStatus, any> { return process(); }\r\n}\r\nexport class ChildStoredList<K extends string, ID extends Pick<any, K>, KK extends Record<K, string>,\r\n  key extends K, T extends TRec<K, KK>, V extends T, P extends T, pimpl extends AbstractEntities<K, KK, P, any>,\r\n  stores extends ChildStores<K, ID, KK, T, V, P, pimpl, AbstractStores<K, ID, KK, P, any, pimpl>>,\r\n  PL extends AbstractStoredList<K, ID, KK, key, P, any, pimpl, AbstractStores<K, ID, KK, P, any, pimpl>>>\r\n  extends AbstractStoredList<K, ID, KK, key, T, V, ChildEntitiesImpl<K, KK, T, V, P, pimpl>, stores> {\r\n  readonly parent: PL\r\n  constructor(params: Params<K, ID, key, KK, T, V, ChildEntitiesImpl<K, KK, T, V, P, pimpl>, stores> & { parent: PL }) {\r\n    super(params);\r\n    this.parent = params.parent;\r\n  }\r\n  private parentSubscriber = () => new this.promiseCtr<ListStatus>((resolve, reject) => {\r\n    this.parentSubsctiption = this.parent?.entities.subscribe(parentList => asAsync(function* () {\r\n      const key = this.key;\r\n      type impl = ChildEntitiesImpl<K, KK, T, V, P, pimpl>;\r\n      const flowList: EntitiesFlow<K, KK, T, V, impl>[]\r\n        = parentList.list.map(e => this.keys.mapTo<EntitiesFlow<K, KK, T, V, impl>>(\r\n          <k extends K>(k: k) => {\r\n            const stores: ChildStores<K, ID, KK, T, V, P, pimpl, AbstractStores<K, ID, KK, P, any, pimpl>> = this.stores;\r\n            return stores[k].get(this.keyofEntity(k, e[k]));\r\n          }));\r\n      const entitiesSet = new Set(this.list?.data.map(u => u.entity[key]));\r\n      const parentEntities = yield* wait(this.toPromise(flowList));\r\n\r\n      const newIds = parentEntities.filter(e => !entitiesSet.has(e.entity[key])).map(\r\n        e => this.keys.mapTo<ID>(k => this.keyofEntity(k, e.entity[k]))\r\n      );\r\n      // console.log('newIds', newIds, this.store);\r\n      const newEntities: EntityWithSubscrition<K, KK, T, V, impl>[] = yield* wait(this.toPromise(newIds.map(id => this.keys.mapTo(\r\n        <k extends K>(k: k) => this.stores[k].get(id[k])\r\n      ))));\r\n      // unsubscribe after new subscription made to reuse recently created entities\r\n      parentEntities.forEach(s => s.subscription.unsubscribe());\r\n      if (!this.list) return reject();\r\n      const newList = this.merge(key, this.list.data, newEntities);\r\n      this.list = { data: newList, status: this._status(this.list.status, parentList.status) };\r\n      this.subscriber?.next({ list: this.list.data.map(({ entity }) => entity), status: this.list.status });\r\n      return resolve(this.list.status);\r\n    }, this.promiseCtr, this)());\r\n  });\r\n\r\n  *fromParent(n: number) {\r\n    try {\r\n      const parentDone = yield* wait(this.parentSubsctiption ? this.parent.exec(n, null) : this.parentSubscriber());\r\n      return parentDone;\r\n    } catch (e) {\r\n      // unsubscribed while retrieving data from parent\r\n      return true;\r\n    }\r\n  }\r\n  *handleError(n: number, e: any) {\r\n    try {\r\n      const parentDone = yield* wait(this.parentSubsctiption ? this.parent.exec(n, e) : this.parentSubscriber());\r\n      return this._status(null, parentDone);\r\n    } catch (e) {\r\n      // unsubscribed while retrieving data from parent\r\n      return true;\r\n    }\r\n  }\r\n\r\n}\r\n","import { Observable, TeardownLogic, Subscriber, Subscription, Subject, of } from 'rxjs';\r\nimport { PromiseCtr, Rec } from './common';\r\nimport { EntityFlow, Entity, ChildEntityImpl, EntityImpl, entityFlow, toEntity, EntityAbstract, $rewind, $update, getEntity } from \"./entity\";\r\n\r\ninterface IStore<ID, K extends string, T extends Rec<K>, V extends T> {\r\n  get(id: ID, skipCurrent?: true): EntityFlow<K, T, V>;\r\n}\r\n\r\ntype DepEntityImpl<K extends string, T extends Rec<K>, V extends T, child extends boolean, P extends T> = child extends true\r\n  ? ChildEntityImpl<K, T, V, P, EntityAbstract<K, P, any>> : EntityAbstract<K, T, V>;\r\n\r\ntype Item<ID, K extends string, T extends Rec<K>, V extends T, impl extends EntityAbstract<K, T, V>> = {\r\n  id: ID, observers: Subscriber<Entity<K, T, V>>[], entity?: Entity<K, T, V, impl>,\r\n  next?: PromiseLike<void>, parentSubscription?: Subscription, closed?: true, ready?: true;\r\n}\r\n\r\nexport abstract class AbstractStore<ID, K extends string, T extends Rec<K>, V extends T, impl extends EntityAbstract<K, T, V>> implements IStore<ID, K, T, V> {\r\n  protected _items = new Map<ID, Item<ID, K, T, V, impl>>();\r\n  readonly insersions = new Subject<ID[]>();\r\n  readonly emptyInsersions = new Subject<ID>();\r\n\r\n  constructor(\r\n    readonly name: string,\r\n    private finalize: (id: ID, entity: Entity<K, T, V, impl>) => void,\r\n    readonly promiseCtr: PromiseCtr,\r\n  ) { }\r\n\r\n  rewind(id: ID) {\r\n    const item = this._items.get(id);\r\n    getEntity(item?.entity)?.rewind();\r\n  }\r\n  /**\r\n   * Ensures the existance of an entity with a givin id using a givin construction logic\r\n   * @param id id of the item to be prepared\r\n   * @param handler the asynchronous function to be executed in order to prepare the item\r\n   * @returns an observable that holds the logic behind the entity construction\r\n   */\r\n  prepare(\r\n    id: ID,\r\n    handler: (\r\n      id: ID, item: { readonly ready?: true; },\r\n      join: (subsciption: Subscription) => void\r\n    ) => void | PromiseLike<void>\r\n  ): Observable<Entity<K, T, V, impl>> {\r\n    const entityFlow = this.get(id);\r\n    return new Observable<Entity<K, T, V, impl>>(subscriber => {\r\n      const subsciption = entityFlow.observable.subscribe(subscriber);\r\n      const item = this._items.get(id);\r\n      if (!item) return; // assert item is not null (unless id has changed)\r\n      // if the item exists but not because of `prepare` call, execute the handler anyway\r\n      const next = item.next = (item.next || {\r\n        then: (_: void, catcher: () => void) => {\r\n          try { return this.promiseCtr.resolve(catcher()); } catch (e) { return this.promiseCtr.reject(e); }\r\n        }\r\n      }).then(undefined, () => {\r\n        const i = item;\r\n        if (!item.closed && !item.ready) {\r\n          return handler(item.id, { get ready() { return i.ready } }, subs => subsciption.add(subs));\r\n        }\r\n      });\r\n      next.then(undefined, () => { });\r\n      return subsciption;\r\n    });\r\n  }\r\n\r\n  nextBulk(items: { id: ID, data: V; }[]) {\r\n    const insersions = items.filter(({ id, data }) => this._next(id, data)).map(({ id }) => id);\r\n    this.insersions.next(insersions);\r\n  }\r\n\r\n  next(id: ID, data: V) {\r\n    if (this._next(id, data)) this.insersions.next([id]);\r\n  }\r\n\r\n  private _next(id: ID, data: V) {\r\n    const item = this._items.get(id);\r\n    if (!item) return;\r\n    if (item.entity) {\r\n      $update(item.entity, data);\r\n      item.ready = true;\r\n      return false;\r\n    } else {\r\n      this.setItemEntity(id, data, item);\r\n      const entity = item.entity;\r\n      item.ready = true;\r\n      item.observers.forEach(subscriber => subscriber.next(entity));\r\n      return true;\r\n    }\r\n  }\r\n\r\n  abstract setItemEntity(id: ID, data: V, item: Item<ID, K, T, V, impl>): void;\r\n  abstract linkParentNewId(oldId: ID, newId: ID, item: Item<ID, K, T, V, impl>): void;\r\n  abstract subscribeToParent(id: ID, item: Item<ID, K, T, V, impl>, skipCurrent?: true): void;\r\n\r\n  updateId(oldId: ID, newId: ID) {\r\n    /** @TODO consider when newId is taken */\r\n    if (this._items.get(newId)) throw new Error('New Id \"' + newId + '\" is taken');\r\n    const item = this._items.get(oldId);\r\n    if (!item) return;\r\n    item.id = newId;\r\n    this._items.delete(oldId);\r\n    this._items.set(newId, item);\r\n    getEntity(item.entity)?.setParent();\r\n    item.parentSubscription?.unsubscribe();\r\n    this.linkParentNewId(oldId, newId, item);\r\n  }\r\n\r\n  update<M extends K>(id: ID, data: Pick<V, M>) {\r\n    getEntity(this._items.get(id)?.entity)?.update(data);\r\n  }\r\n\r\n  private item(id: ID, observer: Subscriber<Entity<K, T, V>>) {\r\n    let item = this._items.get(id);\r\n    if (!item) this._items.set(id, item = { id, observers: [observer] });\r\n    else item.observers.push(observer);\r\n    return item;\r\n  }\r\n\r\n  get(id: ID, skipCurrent?: true): EntityFlow<K, T, V, impl> {\r\n    return entityFlow<K, T, V, impl>(\r\n      new Observable((subscriber: Subscriber<Entity<K, T, V, impl>>): TeardownLogic => {\r\n        const item = this.item(id, subscriber);\r\n        const observers = item.observers;\r\n        if (item.entity) {\r\n          if (!skipCurrent) subscriber.next(item.entity);\r\n        } else {\r\n          this.subscribeToParent(id, item, skipCurrent);\r\n        }\r\n        return () => {\r\n          const id = item.id, i = observers.indexOf(subscriber);\r\n          if (i !== -1) observers.splice(i, 1);\r\n          if (!observers.length) {\r\n            const subscription = item.parentSubscription;\r\n            this._items.delete(id);\r\n            item.closed = true;\r\n            // debugger;\r\n            if (item.entity) {\r\n              this.finalize(id, item.entity);\r\n            }\r\n            if (subscription) {\r\n              subscription.unsubscribe();\r\n            }\r\n          }\r\n        };\r\n      }));\r\n  }\r\n}\r\n\r\n\r\nexport class ChildStore<ID, K extends string, T extends Rec<K>, V extends T, P extends T, pimpl extends EntityAbstract<K, P, any>, PS extends AbstractStore<ID, K, P, any, pimpl>> extends AbstractStore<ID, K, T, V, ChildEntityImpl<K, T, V, P, pimpl>> {\r\n\r\n  constructor(\r\n    name: string,\r\n    finalize: (id: ID, entity: Entity<K, T, V, ChildEntityImpl<K, T, V, P, pimpl>>) => void,\r\n    promiseCtr: PromiseCtr,\r\n    readonly parent: PS,\r\n  ) { super(name, finalize, promiseCtr) }\r\n\r\n  setItemEntity(id: ID, data: V, item: Item<ID, K, T, V, ChildEntityImpl<K, T, V, P, pimpl>>) {\r\n    const parentFlow = this.parent.get(id);\r\n    item.entity = toEntity(new ChildEntityImpl<K, T, V, P, pimpl>({\r\n      data, ready: false, parentPromise: {\r\n        then: (setParent: (parent: Entity<K, P, any, pimpl>) => void) => {\r\n          const subscription = parentFlow.observable.subscribe(parent => setParent(parent));\r\n          item.parentSubscription?.unsubscribe();\r\n          item.parentSubscription = subscription;\r\n        }\r\n      }\r\n    }));\r\n  }\r\n\r\n  linkParentNewId(_oldId: ID, newId: ID, item: Item<ID, K, T, V, ChildEntityImpl<K, T, V, P, pimpl>>) {\r\n    const parentFlow = this.parent.get(newId);\r\n    const entity = item.entity;\r\n    if (!entity) return;\r\n    item.parentSubscription = parentFlow.observable.subscribe(parent => {\r\n      getEntity(entity).setParent(parent);\r\n    });\r\n  }\r\n\r\n  subscribeToParent(id: ID, item: Item<ID, K, T, V, ChildEntityImpl<K, T, V, P, pimpl>>, skipCurrent?: true) {\r\n    if (!item.parentSubscription) {\r\n      const observers = item.observers;\r\n      let run = !skipCurrent;\r\n      // this._entities.set will not be runned when .next is invoked because it will be already unsubscribed\r\n      item.parentSubscription = this.parent.get(id).observable.subscribe(parent => {\r\n        item.entity = toEntity(new ChildEntityImpl<K, T, V, P, pimpl>({ data: {}, parent, ready: true }));\r\n        this.emptyInsersions.next(item.id);\r\n        if (run) observers.forEach(subscriber => subscriber.next(item.entity));\r\n      });\r\n      run = true;\r\n    }\r\n  }\r\n}\r\n\r\nexport class TopStore<ID, K extends string, T extends Rec<K>, V extends T = T> extends AbstractStore<ID, K, T, V, EntityImpl<K, T, V>> {\r\n  constructor(\r\n    name: string,\r\n    finalize: (id: ID, entity: Entity<K, T, V, EntityImpl<K, T, V>>) => void,\r\n    promiseCtr: PromiseCtr,\r\n  ) { super(name, finalize, promiseCtr) }\r\n\r\n  setItemEntity(_id: ID, data: V, item: Item<ID, K, T, V, EntityImpl<K, T, V>>) {\r\n    item.entity = toEntity<K, T, V, EntityImpl<K, T, V>>(\r\n      new EntityImpl<K, T, V>(data)) as Entity<K, T, V, EntityImpl<K, T, V>>;\r\n  }\r\n\r\n  linkParentNewId() { }\r\n\r\n  subscribeToParent() { }\r\n\r\n}","module.exports = __WEBPACK_EXTERNAL_MODULE_rxjs__;","module.exports = __WEBPACK_EXTERNAL_MODULE_rxjs_operators__;"],"sourceRoot":""}